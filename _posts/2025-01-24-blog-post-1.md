---
title: 'Synthetic Controls in Dense Settings'
date: 2025-01-24
permalink: /posts/2025/01/scdense/
---

Plenty of posts have been done in the last decade on [the synthetic control method](https://doi.org/10.1198/jasa.2009.ap08746) and related approaches; folks from [Microsoft](https://medium.com/data-science-at-microsoft/causal-inference-using-synthetic-controls-d96a890c83a7), [Databricks](https://towardsdatascience.com/how-to-do-causal-inference-using-synthetic-controls-ab435e0228f1), [Uber](https://youtu.be/j5DoJV5S2Ao?si=RWUYFjFEWpvkl8x1), [Amazon](https://towardsdatascience.com/causal-inference-with-synthetic-control-in-python-4a79ee636325), [Netflix](https://netflixtechblog.com/round-2-a-survey-of-causal-inference-applications-at-netflix-fd78328ee0bb), [Gainwell Technologies](https://andrewpwheeler.com/2019/12/06/using-regularization-to-generate-synthetic-controls-and-conformal-prediction-for-significance-tests/), and [else](https://rudrendupaul.medium.com/causal-inference-part-7-synthetic-control-methods-a-powerful-technique-for-inferring-causality-in-3ec5dbe26038)[where](https://henamsingla.medium.com/synthetic-control-method-a-z-d28099c56edb) have gone over it, detailing different aspects of the method. Many (not of course [not all](https://peerunreviewed.blogspot.com/2019/11/a-short-tutorial-on-robust-synthetic.html)) of these go over the standard SCM. Broadly, the original SCM tends to favor, under certain technical conditions, a sparse set of control units being the underlying weights. And while sparsity has plenty of appealing properties, such as our ability to interpret the synthetic control, sometimes this advice simply breaks down because [in some cases](https://ceistorvergata.it/public/files/RFCS/Giannone_illusion4-2.pdf) the sparsity notion is wrong. In other words, most of the coefficeints being 0 is a notion that cannot be defended. So in this post, I demonstrate [the](10.13140/RG.2.2.11670.97609) $\ell_2$ panel data approach, an econometric methodology by [Zhentao Shi](https://zhentaoshi.github.io/) and [Yishu Wang](https://ishwang1.github.io/) which accommodates dense data generation processes, or when the true vector of coefficient is mostly not zero.

> **Note:**  
This post goes over an extended empirical example. To see the simple and fast way to use this method, you can go to [the Python documentation](https://mlsynth.readthedocs.io/en/latest/pda.html#ell-2-relaxation) of this method in my packiage ``mlsynth`` which is both slightly more technical and a lot shorter than I'll be here.

# A Review of Synthetic Controls

Our goal is to estimate the counterfactual outcome, denoted as \( y_{1t}^0 \), which represents the values of an outcome for a treated unit that we would observe if the intervention had never occurred. The challenge is that we can only observe the actual outcomes, which are defined as \( y_{it} = y_{it}^1 d_{it} + \left(1 - d_{it}\right)y_{it}^0 \), where \( y_{it} \) is the observed outcome, \( d_{it} \) is an indicator for whether the unit is treated (\( d_{it} = 1 \)) or untreated (\( d_{it} = 0 \)), and the indices \( t \in \mathbb{N} \) and \( i \in \mathbb{N} \) denote time periods and units, respectively. 

Let \( i = 1 \) represent the treated unit, and let the remaining units form the control group, which remains untreated. An intervention occurs at time \( T_0 \), such that \( t = \{1, 2, \ldots, T_0\} \) corresponds to the pre-treatment period, and \( t = \{T_0 + 1, \ldots, T\} \) corresponds to the post-treatment period. The objective is to estimate the counterfactual \( y_{1t}^0 \) for the treated unit in the post-treatment period.

The original Synthetic Control Method (SCM) proposes constructing a convex combination of weights, \( \mathbf{w} \), to approximate the trajectory of the treated unit's outcomes, \( \mathbf{y}_1 \), during the pre-treatment period. Specifically, these weights are applied to the donor pool matrix, \( \mathbf{Y}_0 \in \mathbb{R}^{N_0 \times T_0} \), which contains the outcomes of the control units over time. The weights \( \mathbf{w} \) are constrained such that \( \mathbf{w} \in [0, 1] \), meaning each weight is non-negative, and \( \|\mathbf{w}\|_1 = 1 \), meaning the weights sum to one. In theory, if the synthetic control approximates the treated unit's outcomes well during the pre-treatment period, the out-of-sample predictions for the post-treatment period, which represent the counterfactual outcomes, will also be unbiased.



